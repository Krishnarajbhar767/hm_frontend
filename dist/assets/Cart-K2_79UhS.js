import{u as L,e as M,d as A,r as f,j as e,m as o,A as W,V as P,i as C,k as Y,h as Q,l as G,B as X,n as K,o as U,p as z,R as $,a as J,F as Z,q as ee,g as se}from"./index-DRzNUvPi.js";import{F,T as k}from"./Constant-B8kb6R2V.js";import{u as te}from"./useOffer-CxBbbVwP.js";function ae({total:s,onCheckout:n,isCheckingOut:l,cartEmpty:m}){return e.jsxs("div",{className:"sticky top-0 z-10 bg-white border-b border-foreground/50 pb-3 flex justify-between items-center lg:hidden mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium",children:"Cart Total:"}),e.jsxs("p",{className:"text-base font-bold",children:["₹",s.toFixed(2)]})]}),e.jsx(o.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:n,disabled:m||l,className:"bg-foreground text-white px-4 py-2 text-sm uppercase disabled:bg-gray-200 disabled:text-gray-500",children:l?e.jsx(o.div,{animate:{rotate:360},transition:{repeat:Number.POSITIVE_INFINITY,duration:1},className:"w-4 h-4 border-2 border-t-transparent border-foreground"}):"Checkout"})]})}function re(){return e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-5 uppercase text-foreground font-medium text-xs sm:text-sm border-b border-foreground/50 pb-2 mb-3 sm:mb-4",children:[e.jsx("h1",{className:"text-left col-span-1",children:"Product"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 col-span-1 sm:col-span-4 text-right gap-2",children:[e.jsx("h1",{className:"sm:hidden",children:"Details"}),e.jsx("h1",{className:"hidden sm:block",children:"Price"}),e.jsx("h1",{className:"hidden sm:block",children:"Quantity"}),e.jsx("h1",{className:"hidden sm:block",children:"Subtotal"}),e.jsx("h1",{className:"hidden sm:block",children:"Action"})]})]})}function ne({item:s,idx:n,onIncrement:l,onDecrement:m,onRemove:r}){const u=s.finalPrice*s.quantity,d=Array.isArray(s.images)?s.images[0]:s.image;return L(),e.jsxs(o.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.3,delay:n*.1},whileHover:{scale:1.01},className:"grid grid-cols-1 sm:grid-cols-5 gap-2 sm:gap-4 md:gap-6 items-start sm:items-center border-b border-foreground/50 pb-3 sm:pb-4",children:[e.jsxs("div",{className:"flex items-start sm:items-center gap-2 sm:gap-3 md:gap-4 col-span-1 sm:col-span-2 cursor-pointer",children:[e.jsx(o.img,{src:d,alt:s.name,className:"w-16 h-16 sm:w-20 sm:h-20 md:w-24 md:h-24 object-cover object-top",whileHover:{scale:1.05},transition:{duration:.2}}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-xs sm:text-sm md:text-base font-medium text-foreground capitalize line-clamp-1",children:s.name}),(s.addons.withFallPico||s.addons.withTassels)&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Addons:",s.addons.withFallPico&&` With Fall Pico (+₹${F})`,s.addons.withFallPico&&s.addons.withTassels&&", ",s.addons.withTassels&&`With Tassels (+₹${k})`]}),e.jsxs("div",{className:"sm:hidden flex flex-col mt-2 gap-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-foreground",children:"Price:"}),e.jsxs("span",{className:"text-xs text-foreground s",children:["₹",s.finalPrice.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-foreground",children:"Quantity:"}),e.jsxs("div",{className:"flex items-center justify-center border border-foreground/50 w-20 py-1",children:[e.jsx(o.button,{disabled:s.quantity<=1,onClick:()=>m(s._id,-1,n),whileTap:{scale:.9},className:"px-1 py-1 text-foreground hover:text-primary text-xs",children:"–"}),e.jsx("input",{type:"text",value:s.quantity,readOnly:!0,className:"w-8 text-center border-x border-foreground/50 text-xs text-foreground"}),e.jsx(o.button,{onClick:()=>l(s._id,1,n),disabled:s.stock<=1,whileTap:{scale:.9},className:"px-1 py-1 text-gray-600 hover:text-primary text-xs",children:"+"})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-foreground",children:"Subtotal:"}),e.jsxs(o.span,{initial:{scale:1.2,color:"#16a34a"},animate:{scale:1,color:"#1f2937"},transition:{duration:.3},className:"text-xs text-foreground",children:["₹",u.toFixed(2)]},u)]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-foreground",children:"Action:"}),e.jsx(o.button,{onClick:()=>r(s._id,n),whileHover:{scale:1.1,color:"#b91c1c"},whileTap:{scale:.9},className:"text-red-500 text-xs",children:"Remove"})]})]})]})]}),e.jsxs("div",{className:"hidden sm:grid sm:grid-cols-4 col-span-3 items-center justify-items-center gap-2 sm:gap-4 md:gap-6",children:[e.jsxs("span",{className:"text-xs sm:text-sm md:text-base text-foreground",children:["₹",s.finalPrice.toFixed(2)]}),e.jsxs("div",{className:"flex items-center justify-center border border-foreground/50 w-20 sm:w-24 py-2 sm:py-3",children:[e.jsx(o.button,{disabled:s.quantity<=1,onClick:()=>m(s._id,-1,n),whileTap:{scale:.9},className:"px-1 sm:px-2 py-1 text-foreground hover:text-primary text-xs sm:text-sm",children:"–"}),e.jsx("input",{type:"text",value:s.quantity,readOnly:!0,className:"w-8 sm:w-10 text-center border-x border-foreground/50 text-xs sm:text-sm text-foreground"}),e.jsx(o.button,{onClick:()=>l(s._id,1,n),disabled:s.stock<=1,whileTap:{scale:.9},className:"px-1 sm:px-2 py-1 text-foreground hover:text-primary text-xs sm:text-sm",children:"+"})]}),e.jsxs(o.span,{initial:{scale:1.2,color:"#533e2d"},animate:{scale:1,color:"#533e2d"},transition:{duration:.3},className:"text-sm sm:text-base md:text-lg font-normal text-foreground",children:["₹",u.toFixed(2)]},u),e.jsx(o.button,{onClick:()=>r(s._id,n),whileHover:{scale:1.1,color:"#b91c1c"},whileTap:{scale:.9},className:"text-red-500 text-xs sm:text-sm md:text-base",children:"Remove"})]})]})}function ie(){return e.jsxs(o.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"text-center py-8 sm:py-12",children:[e.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 mx-auto mb-4 flex items-center justify-center bg-gray-100",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-8 h-8 sm:w-10 sm:h-10 text-foreground",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})}),e.jsx("p",{className:"text-foreground text-sm sm:text-base mb-2",children:"Your cart is empty"}),e.jsx("p",{className:"text-foreground text-xs sm:text-sm mb-6",children:"Add items to your cart to continue shopping"}),e.jsx("button",{onClick:()=>navigate("Navigate Products Page"),className:"bg-foreground text-white px-4 py-2 text-xs sm:text-sm uppercase",children:"Continue Shopping"})]})}function oe({cartItems:s,subtotal:n,discount:l,total:m,coupon:r,setCoupon:u,applyCoupon:d,handleCheckout:a,isCheckingOut:i,cartEmpty:c,appliedCoupon:p,removeCoupon:g,discountPercentage:j}){return e.jsxs(o.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.4},className:"col-span-1 p-3 sm:p-4 md:p-6 border shadow-sm",children:[e.jsx("h2",{className:"text-xs sm:text-sm md:text-base font-medium uppercase text-foreground mb-3 sm:mb-4",children:"Order Summary"}),e.jsxs("div",{className:"space-y-4 text-xs sm:text-sm md:text-base",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Your Cart"}),s.map((t,x)=>{const w=t.finalPrice-(t.addons.withFallPico?F:0)-(t.addons.withTassels?k:0),T=t.finalPrice*t.quantity;return e.jsxs("div",{className:"mb-3 border-b pb-2 capitalize",children:[e.jsx("p",{className:"font-medium line-clamp-1 capitalize",children:t.name}),e.jsxs("p",{children:["Base Price: ₹",w.toFixed(2)," ×"," ",t.quantity," = ₹",(w*t.quantity).toFixed(2)]}),t.addons.withFallPico&&e.jsxs("p",{children:["With Fall Pico: +₹",F," ×"," ",t.quantity," = ₹",(F*t.quantity).toFixed(2)]}),t.addons.withTassels&&e.jsxs("p",{children:["With Tassels: +₹",k," ×"," ",t.quantity," = ₹",(k*t.quantity).toFixed(2)]}),e.jsxs("p",{className:"font-medium",children:["Item Total: ₹",T.toFixed(2)]})]},x)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center font-medium",children:[e.jsx("span",{children:"Subtotal"}),e.jsxs("span",{children:["₹",n.toFixed(2)]})]}),l>0&&e.jsxs(o.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3},className:"flex justify-between text-green-600",children:[e.jsx("span",{children:"Discount"}),e.jsxs("span",{children:["-₹",l.toFixed(2)]})]}),e.jsx("div",{className:"border-t border-foreground/50 pt-2 sm:pt-3 mt-2 sm:mt-3",children:e.jsxs("div",{className:"flex justify-between text-sm sm:text-base md:text-lg font-semibold text-foreground",children:[e.jsx("span",{children:"Total"}),e.jsxs(o.span,{initial:{scale:1.2,color:"#533e2d"},animate:{scale:1,color:"#533e2d"},transition:{duration:.3},children:["₹",m.toFixed(2)]},m)]})})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx("input",{type:"text",value:r,onChange:t=>u(t.target.value),placeholder:"Enter coupon code",className:"uppercase flex-1 border border-foreground/50 px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm focus:outline-none focus:ring-1 focus:ring-foreground"}),e.jsx(o.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsx(X,{text:"Apply",onSubmitHandler:d,className:"text-xs sm:text-sm py-1 sm:py-2 px-3 sm:px-4"})})]}),p&&e.jsxs("div",{className:"mt-2 text-sm text-green-600",children:["Applied coupon: ",p," (",j,"% off)",e.jsx(o.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:g,className:"ml-2 text-red-500",children:"Remove"})]})]})]}),e.jsx(o.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:a,disabled:c||i,className:`hidden lg:flex group relative h-9 sm:h-10 md:h-12 items-center justify-center overflow-hidden px-3 sm:px-4 md:px-6 font-light text-neutral-200 text-xs sm:text-sm md:text-base tracking-wide w-full mt-2 sm:mt-4 uppercase ${c?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-foreground"}`,children:i?e.jsx(o.div,{animate:{rotate:360},transition:{repeat:Number.POSITIVE_INFINITY,duration:1},className:"w-4 h-4 sm:w-5 sm:h-5 border-2 border-t-transparent border-white"}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Proceed To Checkout"}),e.jsx("div",{className:"absolute inset-0 flex h-full w-full justify-center [transform:skew(-12deg)_translateX(-100%)] group-hover:duration-1000 group-hover:[transform:skew(-12deg)_translateX(100%)]",children:e.jsx("div",{className:"relative h-full w-6 sm:w-8 bg-white/20"})})]})})]})}function le({cartItems:s,isBuyNow:n,setLocalQty:l,setBuyNowItem:m,setStepCount:r}){const u=L(),d=M(),a=A(h=>h.user.user),i=s.reduce((h,b)=>h+b.finalPrice*b.quantity,0),[c,p]=f.useState(""),[g,j]=f.useState(0),[t,x]=f.useState(null),[w,T]=f.useState(!1),I=i*g/100,S=i-I,N=s.length===0,_=async()=>{var h,b;if(!c.trim()){P.error("Please enter a coupon code");return}if(c===t){P.info("Coupon already applied");return}try{const v=(await C.post("/user/coupon/apply",{couponCode:c})).data;typeof v=="number"&&v>0?(j(v),x(c),d(U({discountPercentage:v})),P.success("Coupon applied successfully!")):P.error("Invalid coupon code")}catch(y){P.error(((b=(h=y==null?void 0:y.response)==null?void 0:h.data)==null?void 0:b.message)||"Failed to  apply coupon"),console.error(y)}},R=()=>{j(0),x(null),p(""),d(K),P.success("Coupon removed")},E=()=>{if(N){P.error("Your cart is empty");return}if(!a){u("/login");return}T(!0),r(h=>h+1)},B=async(h,b,y)=>{console.log(h);const v=s[y];if(!v||v._id!==h)return;if(n){l(q=>Math.max(1,b>0?q+1:q-1));return}if(a)try{if(!(await C.post("/user/cart/update-quantity",{userId:a._id,productId:h,withFallPico:v.addons.withFallPico,withTassels:v.addons.withTassels,type:b===1?"increment":"decrement"})).data)return}catch(q){Q(q);return}const D=Math.max(1,v.quantity+b);d(G({id:h,quantity:D,idx:y}))},V=async(h,b)=>{if(n){m(null);return}const y=s[b];a&&await C.post("/user/cart/remove",{userId:a._id,productId:y._id,withFallPico:y.addons.withFallPico,withTassels:y.addons.withTassels}),d(Y({id:h,idx:b}))};return e.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"h-auto w-full max-w-7xl mx-auto py-4 sm:py-6 md:py-8 px-3 sm:px-6 md:px-8",children:[e.jsx(ae,{total:S,onCheckout:E,isCheckingOut:w,cartEmpty:N}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6 md:gap-8 lg:gap-12",children:[e.jsxs(o.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.2},className:"col-span-1 lg:col-span-2",children:[e.jsx(re,{}),N?e.jsx(ie,{}):e.jsx("div",{className:"space-y-3 sm:space-y-4",children:e.jsx(W,{children:s.map((h,b)=>e.jsx(ne,{item:h,idx:b,onIncrement:B,onDecrement:B,onRemove:V},h._id))})})]}),e.jsx(oe,{cartItems:s,subtotal:i,discount:I,total:S,coupon:c,setCoupon:p,applyCoupon:_,handleCheckout:E,isCheckingOut:w,cartEmpty:N,appliedCoupon:t,removeCoupon:R,discountPercentage:g})]}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 p-3 lg:hidden z-10",children:e.jsx(o.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:E,disabled:N||w,className:`group relative flex h-12 items-center justify-center overflow-hidden font-light text-neutral-200 text-sm tracking-wide w-full uppercase ${N?"bg-gray-200 text-gray-500":"bg-foreground"}`,children:w?e.jsx(o.div,{animate:{rotate:360},transition:{repeat:Number.POSITIVE_INFINITY,duration:1},className:"w-5 h-5 border-2 border-t-transparent border-white"}):e.jsxs("span",{children:["Proceed To Checkout • ₹",S.toFixed(2)]})})})]})}const H=({label:s,name:n,type:l="text",rules:m={}})=>{var x;const{register:r,formState:{errors:u},watch:d}=z(),[a,i]=$.useState(!1),[c,p]=$.useState(!1),g=d(n);f.useEffect(()=>{p(!!g)},[g]);const j=()=>i(!0),t=()=>i(!1);return e.jsxs("div",{className:"relative mb-6",children:[e.jsx("input",{id:n,name:n,type:l,className:"w-full p-3 py-4 border-[2px] border-foreground/50 focus:outline-none focus:border-foreground text-foreground transition-all duration-100 ease-linear",placeholder:" ",...r(n,m),onFocus:j,onBlur:t,onAnimationStart:w=>{w.animationName==="onAutoFillStart"&&p(!0)}}),e.jsx("label",{htmlFor:n,className:`absolute capitalize px-2 z-10 bg-white left-3 transition-all duration-200 ${a||c?"top-0 text-xs text-foreground":"top-1/2 text-base text-foreground"} transform ${u[n],"-translate-y-1/2"}`,children:s}),u[n]&&e.jsx("p",{className:"text-red-500 text-xs mt-1 absolute",children:(x=u[n])==null?void 0:x.message})]})},de=({label:s,name:n,options:l,rules:m={}})=>{var i;const{register:r,formState:{errors:u},watch:d}=z(),a=d(n);return f.useEffect(()=>{const c=document.getElementById(n);c&&c.addEventListener("animationstart",p=>{p.animationName==="onAutoFillStart"&&c.dispatchEvent(new Event("change",{bubbles:!0}))})},[n]),e.jsxs("div",{className:"relative mb-6",children:[e.jsxs("select",{id:n,name:n,className:"w-full p-3 py-4 border-[2px] border-foreground/50 focus:outline-none focus:border-foreground text-foreground transition-all duration-100 ease-linear bg-white",...r(n,m),children:[e.jsxs("option",{value:"",disabled:!0,children:["Select ",s]}),l.map(c=>e.jsx("option",{value:c,children:c},c))]}),e.jsx("label",{htmlFor:n,className:`absolute capitalize px-2 z-10 bg-white left-3 transition-all duration-200 ${a?"top-0 text-xs text-foreground":"top-1/2 text-base text-foreground"} transform ${u[n],"-translate-y-1/2"}`,children:s}),u[n]&&e.jsx("p",{className:"text-red-500 text-xs mt-1 absolute",children:(i=u[n])==null?void 0:i.message})]})},ce=["Andhra Pradesh","Arunachal Pradesh","Assam","Bihar","Chhattisgarh","Goa","Gujarat","Haryana","Himachal Pradesh","Jharkhand","Karnataka","Kerala","Madhya Pradesh","Maharashtra","Manipur","Meghalaya","Mizoram","Nagaland","Odisha","Punjab","Rajasthan","Sikkim","Tamil Nadu","Telangana","Tripura","Uttar Pradesh","Uttarakhand","West Bengal","Andaman and Nicobar Islands","Chandigarh","Dadra and Nagar Haveli and Daman and Diu","Delhi","Jammu and Kashmir","Ladakh","Lakshadweep","Puducherry"],ue={street:"",city:"",state:"",postalCode:"",phone:""},xe=({addresses:s,setAddresses:n})=>{const[l,m]=f.useState("new"),r=z();f.useEffect(()=>{(async()=>{try{const{data:a}=await C.get("/user/address/getAll");n((a==null?void 0:a.addresses)||[])}catch(a){console.error("Error fetching addresses:",a)}})()},[]),f.useEffect(()=>{r.setValue("addressId",l)},[l,r]);const u=f.useCallback(d=>{const a=d.target.value;if(m(a),a==="new"){r.reset(ue),r.setFocus("street");return}const i=s.find(c=>c._id===a);if(!i){console.warn("Selected address not found");return}r.setValue("street",i.street),r.setValue("city",i.city),r.setValue("state",i.state),r.setValue("postalCode",i.postalCode),r.setValue("phone",i.phone)},[s,r]);return e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-lg font-semibold uppercase text-foreground mb-4",children:"Shipping Information"}),s.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Saved Address"}),e.jsxs("select",{value:l,onChange:u,defaultValue:"new",className:"w-full p-3 py-4 border-[2px] border-foreground/50 focus:outline-none focus:border-foreground text-foreground transition-all duration-100 ease-linear bg-white",children:[e.jsx("option",{value:"new",disabled:!0,hidden:!0,children:"Select an address or add new"}),s.map(d=>e.jsx("option",{value:d._id,children:`${d.street}, ${d.city}, ${d.state}`},d._id)),e.jsx("option",{value:"new",children:"Add New Address"})]})]}),e.jsx("input",{type:"hidden",...r.register("addressId")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(H,{label:"Street Address",name:"street",rules:{required:"Street address is required",minLength:{value:5,message:"Minimum 5 characters"}}}),e.jsx(H,{label:"City",name:"city",rules:{required:"City is required",pattern:{value:/^[A-Za-z\s]+$/,message:"Letters & spaces only"}}}),e.jsx(de,{label:"State",name:"state",options:ce,rules:{required:"State is required"}}),e.jsx(H,{label:"Postal Code",name:"postalCode",rules:{required:"Postal code is required",pattern:{value:/^\d{6}$/,message:"6 digits required"}}}),e.jsx("div",{className:"sm:col-span-2",children:e.jsx(H,{label:"Phone",name:"phone",type:"tel",rules:{required:"Phone number is required",pattern:{value:/^\d{10}$/,message:"10 digits required"}}})})]})]})},O=$.memo(function({cartItems:n,subtotal:l,gst:m,total:r}){const u=A(a=>{var i;return(i=a==null?void 0:a.cart)==null?void 0:i.discountPercentage}),d=l*u/100;return e.jsxs(o.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.4},className:"col-span-1 p-3 sm:p-4 md:p-6 border shadow-sm",children:[e.jsx("h2",{className:"text-xs sm:text-sm md:text-base font-medium uppercase text-foreground mb-3 sm:mb-4",children:"Order Summary"}),e.jsxs("div",{className:"space-y-4 text-xs sm:text-sm md:text-base",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Your Cart"}),n.map((a,i)=>{const c=a.finalPrice-(a.addons.withFallPico?F:0)-(a.addons.withTassels?k:0),p=a.finalPrice*a.quantity;return e.jsxs("div",{className:"mb-3 border-b pb-2 capitalize ",children:[e.jsx("p",{className:"font-medium line-clamp-2",children:a.name}),e.jsxs("p",{children:["Base Price: ₹",c.toFixed(2)," ×"," ",a.quantity," = ₹",(c*a.quantity).toFixed(2)]}),a.addons.withFallPico&&e.jsxs("p",{children:["With Fall Pico: +₹",F," ×"," ",a.quantity," = ₹",(F*a.quantity).toFixed(2)]}),a.addons.withTassels&&e.jsxs("p",{children:["With Tassels: +₹",k," ×"," ",a.quantity," = ₹",(k*a.quantity).toFixed(2)]}),e.jsxs("p",{className:"font-medium",children:["Item Total: ₹",p.toFixed(2)]})]},i)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center font-medium",children:[e.jsx("span",{children:"Subtotal"}),e.jsxs("span",{children:["₹",l.toFixed(2)]})]}),d>0&&e.jsxs(o.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3},className:"flex justify-between text-green-600",children:[e.jsx("span",{children:"Discount"}),"....",e.jsxs("span",{children:["-₹",d.toFixed(2)]})]}),e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("span",{className:"text-sm",children:["Including ₹",m," in taxes (5% GST)"]})}),e.jsx("div",{className:"border-t border-foreground/50 pt-2 sm:pt-3 mt-2 sm:mt-3",children:e.jsxs("div",{className:"flex justify-between text-sm sm:text-base md:text-lg font-semibold text-foreground",children:[e.jsx("span",{children:"Total"}),e.jsxs(o.span,{initial:{scale:1.2,color:"#533e2d"},animate:{scale:1,color:"#533e2d"},transition:{duration:.3},children:["₹",r.toFixed(2)]},r)]})})]})]})]})});function me({cartItems:s,setStepCount:n}){const[l,m]=f.useState([]),r=A(t=>{var x;return(x=t==null?void 0:t.user)==null?void 0:x.user}),u=A(t=>{var x;return(x=t==null?void 0:t.cart)==null?void 0:x.discountPercentage}),d=te(),a=J(),i=s.reduce((t,x)=>t+x.finalPrice*x.quantity,0),c=+(i*.05).toFixed(2),p=i*u/100,g=p?i-p:i,j=async t=>{console.log("Order That I Have  Created While Making Payment",s);let x=!1;if(t.addressId==="new"){const{data:{address:S}}=await C.post("/user/address/add",t);m(N=>[...N,S]),x=S._id}const{data:{key:w}}=await C.get("/payment/get-razorpay-key"),{data:T}=await C.post("/payment/checkout",{amount:g,userId:r==null?void 0:r._id,items:s,discount:p,offer:d,addressId:x||t.addressId}),I=new window.Razorpay({key:w,amount:T.amount,currency:"INR",name:"Srijan Fabs",description:"",image:"LOGO.avif",order_id:T.id,callback_url:"https://srijanfabs.co.in/api/v1/payment/verify-payment",prefill:{name:(r==null?void 0:r.name)||"",email:(r==null?void 0:r.email)||"",contact:(r==null?void 0:r.phone)||""},notes:{address:"Razorpay Corporate Office"},theme:{color:"#3399cc"}});I.on("payment.failed",S=>{var _;const N=slugify(((_=S.error)==null?void 0:_.reason)||"payment_failed",{lower:!0,strict:!0});window.location.href=`paymentFailed?reason=${N}`}),I.open()};return e.jsx(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"h-auto w-full py-8 bg-white px-4 md:px-8",children:e.jsx(Z,{...a,children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-8",children:[e.jsx("div",{className:"col-span-1 md:col-span-2",children:e.jsxs("form",{onSubmit:a.handleSubmit(j),children:[e.jsx(xe,{addresses:l,setAddresses:m}),e.jsx("div",{className:"block md:hidden",children:e.jsx(O,{cartItems:s,subtotal:i,gst:c,total:g})}),e.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.6},className:"flex flex-col md:flex-row justify-between mt-8 gap-4",children:[e.jsxs(o.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"button",onClick:()=>n(1),className:"flex items-center justify-center gap-2 border-[2px] border-foreground/50 text-foreground h-12 px-4 md:px-6 w-full uppercase hover:border-foreground hover:bg-foreground/5 transition-all duration-200",children:[e.jsx(ee,{className:"text-foreground"}),e.jsx("span",{children:"Back to Shopping Bag"})]}),e.jsx(o.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"submit",disabled:a.formState.isSubmitting,className:"group relative inline-flex h-12 items-center justify-center overflow-hidden bg-foreground px-4 md:px-6 font-light text-neutral-200 text-md tracking-wide w-full uppercase disabled:opacity-50",children:a.formState.isSubmitting?e.jsx(o.div,{animate:{rotate:360},transition:{repeat:1/0,duration:1},className:"w-5 h-5 border-2 border-t-transparent border-white rounded-full"}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Proceed To Confirmation"}),e.jsx("div",{className:"absolute inset-0 flex h-full w-full justify-center [transform:skew(-12deg)_translateX(-100%)] group-hover:duration-1000 group-hover:[transform:skew(-12deg)_translateX(100%)]",children:e.jsx("div",{className:"relative h-full w-8 bg-white/20"})})]})})]})]})}),e.jsx("div",{className:"hidden md:block ",children:e.jsx(O,{cartItems:s,subtotal:i,gst:c,total:g})})]})})})}function ge(){var j;const n=((j=se().state)==null?void 0:j.buyNowItem)||null,[l,m]=f.useState(n),r=!!l,[u,d]=f.useState(()=>l&&l.quantity||1),a=A(t=>t.cart.cartItems),i=r?[{...l,quantity:u}]:a;f.useEffect(()=>{r&&d(l.quantity||1)},[l,r]),i.reduce((t,x)=>t+x.finalPrice*x.quantity,0);const c=[{id:1,heading:"Shopping Bag",subHeading:"Manage Your Items list"},{id:2,heading:"Shipping And Checkout",subHeading:"Checkout your item list"},{id:3,heading:"Confirmation",subHeading:"Review and submit your order"}],[p,g]=f.useState(1);return e.jsxs("div",{className:"boxedContainer h-auto w-full py-4 sm:py-6 md:py-8 px-3 sm:px-6 md:px-8 max-w-7xl mx-auto",children:[e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl lg:text-[35px] font-bold uppercase mb-4 sm:mb-6",children:"Cart"}),e.jsxs("div",{className:"w-full mb-6 sm:mb-8",children:[e.jsxs("div",{className:"relative flex justify-between items-center md:hidden mb-6",children:[e.jsx("div",{className:"absolute top-3 left-0 right-0 h-0.5 bg-foreground"}),c.map(t=>e.jsxs("div",{className:"relative z-10 flex flex-col items-center w-1/3",children:[e.jsx("div",{className:`w-6 h-6 flex items-center justify-center text-xs font-medium
                                    ${p>=t.id?"bg-foreground text-white":"bg-white  border border-foreground text-foreground"}`,children:t.id}),e.jsx("span",{className:"text-[10px] sm:text-xs mt-2 text-center font-medium leading-tight",children:t.heading.split(" ")[0]})]},t.id))]}),e.jsx("div",{className:"hidden md:grid w-full grid-cols-3 gap-4",children:c.map(t=>e.jsxs("div",{className:`flex gap-4 py-2 ${p>=t.id?"border-b-2 border-foreground":"border-b border-foreground/50"}`,children:[e.jsxs("h1",{className:"text-sm md:text-base lg:text-[18px] uppercase font-medium",children:["0",t.id]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-sm md:text-base lg:text-[18px] uppercase font-medium text-foreground",children:t.heading}),e.jsx("h2",{className:"text-foreground text-xs md:text-sm",children:t.subHeading})]})]},t.id))})]}),e.jsxs("div",{className:"w-full",children:[p===1&&e.jsx(le,{cartItems:i,isBuyNow:r,setLocalQty:d,setBuyNowItem:m,setStepCount:g}),p===2&&e.jsx(me,{cartItems:i,setStepCount:g})]})]})}export{ge as default};
